station <- names(prec_mes)[!(names(prec_mes) %in% c("day","month","year"))]
prec_occurence_mes[,station] <- prec_mes[,station]>=valmin
head(prec_occurence_mes)
they <- c("T36133", "T36137", "T44040", "T44120", "T45000", "T45001", "T45002", "T45003", "T45004","T45007") ##station
exogen <- Tx_mes[,they]-Tn_mes[,they]
months <- factor(prec_mes$month)
model <- PrecipitationOccurrenceMultiSiteModel(x=prec_mes[,they],exogen=exogen,origin=origin)
names(model)
class(model[[1]])
class(model$ccgamma)
class(model$K)
class(model$type)
prec_gen_occ <- generate(model,exogen=exogen,monthly.factor=months,n=length(months))
str(prec_gen_occ)
model_amount <- PrecipitationAmountModel(prec_mes,station=they,origin=origin)
names(model_amount)
class(model_amount)
for (its in model_amount$station) summary(model_amount[[its]])
model_amount$station
model_amount$sample
model_amount$origin
model_amount$valmin
prec_gen <- generate(model_amount,newdata=prec_gen_occ)
names(prec_gen)
library(dplyr)
library(ggplot2)
library(lubridate)
library(reshape2)
str(prec_mes)
str(prec_gen)
df <- list(obs=prec_mes[names(prec_gen)],gen=prec_gen)
for ( i in 1:length(df)) {
df[[i]]$date <- as.Date(origin)+days(1:nrow(df[[i]]))-1
}
df <- melt(df,id="date")
names(df)[names(df)=="variable"] <- "station"
names(df)[names(df)=="L1"] <- "variable"
df$month <- factor(month(df$date))
df$season <- "none"
df$season[df$month %in% c(12,2,1)] <- "1.DJF"
df$season[df$month %in% c(3,4,5)] <-  "2.MAM"
df$season[df$month %in% c(6,7,8)] <-  "3.JJA"
df$season[df$month %in% c(9,10,11)] <-  "4.SON"
qqplot_ <- function(df) {
df <- as.list(df)
o <- qqplot(df[[1]],df[[2]],plot.it=FALSE)
names(o) <- names(df)[1:2]
o <- as.data.frame(o)
return(o)
}
qqdf <- split(df,f=paste(df$station,df$season,sep="_")) %>%
lapply(FUN=function(x){list(obs=x$value[x$variable=="obs"],gen=x$value[x$variable=="gen"])}) %>%
lapply(FUN=qqplot_) %>%
melt(id=c("obs","gen"))
qqdf_add <- str_split(qqdf$L1,pattern="_") %>% do.call(what=rbind) %>% as.data.frame()
names(qqdf_add) <- c("station","season")
qqdf <- cbind(qqdf,qqdf_add)
#they <- c("T36133", "T36137", "T44040", "T44120", "T45000", "T45001", "T45002", "T45003", "T45004","T45007")
summary(qqdf)
qqdf_T36133_to_T45000 <- qqdf %>% filter(station %in% c("T36133", "T36137", "T44040", "T44120", "T45000"))
head(qqdf_T36133_to_T45000)
#they <- c("T36133", "T36137", "T44040", "T44120", "T45000", "T45001", "T45002", "T45003", "T45004","T45007")
summary(qqdf)
str(qqdf)
View(qqdf_T36133_to_T45000)
View(qqdf)
qqdf_T36133_to_T45000 <- qqdf %>% filter(station == "T36133")
#qqdf_T36133_to_T45000 <- qqdf %>% filter(station %in% c("T36133", "T36137", "T44040", "T44120", "T45000"))
head(qqdf_T36133_to_T45000)
#qqdf_T36133_to_T45000 <- qqdf %>% filter(station == "T36133")
qqdf_T36133_to_T45000 <- qqdf %>% filter(station %in% c("T36133", "T36137", "T44040", "T44120", "T45000"))
## ggplot plot
ggdf_T36133_to_T45000 <- ggplot(data=qqdf_T36133_to_T45000)+
geom_point(aes(x=obs,y=gen))+
theme_bw()+
geom_abline()+
facet_grid(station ~ season)+xlab("observed")+
ylab("generated")
library(ggplot2)
install.packages(c("ggplot2", "dplyr"))
library(ggplot2)
library(dplyr)
library(dplyr)
install.packages(c("ggplot2", "dplyr"))
install.packages("tidyverse")
install.packages("devtools")
library(dplyr)
library(ggplot2)
library(lubridate)
library(reshape2)
qqdf <- split(df,f=paste(df$station,df$season,sep="_")) %>%
lapply(FUN=function(x){list(obs=x$value[x$variable=="obs"],gen=x$value[x$variable=="gen"])}) %>%
lapply(FUN=qqplot_) %>%
melt(id=c("obs","gen"))
qqdf_add <- str_split(qqdf$L1,pattern="_") %>% do.call(what=rbind) %>% as.data.frame()
names(qqdf_add) <- c("station","season")
qqdf <- cbind(qqdf,qqdf_add)
#they <- c("T36133", "T36137", "T44040", "T44120", "T45000", "T45001", "T45002", "T45003", "T45004","T45007")
summary(qqdf)
str(qqdf)
#qqdf_T36133_to_T45000 <- qqdf %>% filter(station == "T36133")
qqdf_T36133_to_T45000 <- qqdf %>% filter(station %in% c("T36133", "T36137", "T44040", "T44120", "T45000"))
head(qqdf_T36133_to_T45000)
## ggplot plot
ggdf_T36133_to_T45000 <- ggplot(data=qqdf_T36133_to_T45000)+
geom_point(aes(x=obs,y=gen))+
theme_bw()+
geom_abline()+
facet_grid(station ~ season)+xlab("observed")+
ylab("generated")
show(ggdf_T36133_to_T45000)
# Next Five station plots
qqdf_T45001_to_T45007 <- qqdf %>% filter(station %in% c("T45001", "T45002", "T45003", "T45004","T45007"))
head(qqdf_T45001_to_T45007)
ggplot_T45001_to_T45007 <- ggplot(data = qqdf_T45001_to_T45007) +
geom_point(aes(x = obs, y= gen)) +
theme_bw() +
geom_abline() +
facet_grid(station ~ seasons) +
xlab("observed") + ylab("generated")
show(ggplot_T45001_to_T45007)
ggplot_T45001_to_T45007 <- ggplot(data = qqdf_T45001_to_T45007) +
geom_point(aes(x = obs, y= gen)) +
theme_bw() +
geom_abline() +
facet_grid(station ~ season) +
xlab("observed") + ylab("generated")
show(ggplot_T45001_to_T45007)
dw <- list()
dw$obs <- dw.spell(prec_mes[,they],origin=origin)
nn <- names(dw$obs[[1]])
dw$obs <- melt(dw$obs,id=nn)
dw$obs$variable <- "obs"
dw$gen <- dw.spell(prec_gen[,they],origin=origin) %>% melt(id=nn)
dw$gen$variable <- "gen"
dw <- do.call(what=rbind,args=dw)
names(dw)[names(dw)=="L1"] <- "station"
dw$season <- "none"
dw$season[dw$month %in% c(12,2,1)] <- "`1.DJF"
dw$season[dw$month %in% c(12,2,1)] <- "1.DJF"
dw$season[dw$month %in% c(3,4,5)] <-  "2.MAM"
dw$season[dw$month %in% c(6,7,8)] <-  "3.JJA"
dw$season[dw$month %in% c(9,10,11)] <-  "4.SON"
View(dw)
qqdw <- split(dw,f=paste(dw$spell_state,dw$station,dw$season,sep="_")) %>% lapply(FUN=function(x){list(obs=x$spell_length[x$variable=="obs"],gen=x$spell_length[x$variable=="gen"])}) %>% lapply(FUN=qqplot_) %>% melt(id=c("obs","gen"))
View(qqdw)
qqdw_add <- str_split(qqdw$L1,pattern="_") %>% do.call(what=rbind) %>% as.data.frame()
names(qqdw_add) <- c("state","station","season")
qqdw <- cbind(qqdw,qqdw_add)
View(qqdw)
qqdry <- qqdw %>% filter(state == "dry")
View(qqdry)
View(qqdry)
qqdry <- qqdw %>% filter(state == "dry", station %in% c("T45001", "T45002", "T45003", "T45004","T45007"))
qqdry <- qqdw %>% filter(state == "dry", station %in% c("T36133", "T36137", "T44040", "T44120", "T45000"))
qqdry_T36133_to_T45000 <- qqdw %>% filter(state == "dry", station %in% c("T36133", "T36137", "T44040", "T44120", "T45000"))
ggplot_T36133_to_T45000 <- ggplot(data = qqdry_T36133_to_T45000) +
geom_point(aes(x=obs,y=gen))+
theme_bw()+
geom_abline()+
facet_grid(station ~ season)+xlab("observed")+
ylab("generated")
ggplot_dry_T36133_to_T45000 <- ggplot(data = qqdry_T36133_to_T45000) +
geom_point(aes(x=obs,y=gen))+
theme_bw()+
geom_abline()+
facet_grid(station ~ season)+xlab("observed")+
ylab("generated")
show(ggplot_dry_T36133_to_T45000)
# Plots for next 5 station dry
qqdry_T45001_to_T45007 <- qqdw %>% filter(station %in% c("T45001", "T45002", "T45003", "T45004","T45007"))
# Plots for next 5 station dry
qqdry_T45001_to_T45007 <- qqdw %>%
filter(state == "dry",station %in% c("T45001", "T45002", "T45003", "T45004","T45007"))
ggplot_dry_T45001_to_T45007 <- ggplot(data = qqdry_T45001_to_T45007) +
geom_point(aes(x=obs,y=gen))+
theme_bw()+
geom_abline()+
facet_grid(station ~ season)+xlab("observed")+
ylab("generated")
show(ggplot_dry_T45001_to_T45007)
qqwet_T36133_to_T45000 <- qqdw %>%
filter(state == "wet", station %in% c("T36133", "T36137", "T44040", "T44120", "T45000"))
View(qqwet_T36133_to_T45000)
View(qqdw)
ggplot_wet_T36133_to_T45000 <- ggplot(data = qqwet_T36133_to_T45000) +
geom_point(aes(x=obs,y=gen))+
theme_bw()+
geom_abline()+
facet_grid(station ~ season)+xlab("observed")+
ylab("generated")
show(ggplot_wet_T36133_to_T45000)
# Plots for next 5 station dry
qqwet_T45001_to_T45007 <- qqdw %>%
filter(state == "wet",station %in% c("T45001", "T45002", "T45003", "T45004","T45007"))
ggplot_wet_T45001_to_T45007 <- ggplot(data = qqwet_T45001_to_T45007) +
geom_point(aes(x=obs,y=gen))+
theme_bw()+
geom_abline()+
facet_grid(station ~ season)+xlab("observed")+
ylab("generated")
show(ggplot_wet_T45001_to_T45007)
months <- unique(prec_mes$month)
ks_test <- list()
for (m in months) {
ks_test[[m]] <- ks.test(prec_mes[prec_mes$month==m,it1],prec_gen[prec_mes$month==m,it1])
}
View(prec_mes)
for (m in months) {
ks_test[[m]] <- ks.test(prec_mes[prec_mes$month==m,they],prec_gen[prec_mes$month==m,they])
}
prec_mes[prec_mes$month==m,they]
prec_gen[prec_mes$month==m,they]
months <- unique(prec_mes$month)
months
ks_test <- list()
for (m in months) {
ks_test[[m]] <- ks.test(prec_mes[prec_mes$month==m,they],prec_gen[prec_mes$month==m,they])
}
View(prec_gen_occ)
ks_test <- list()
for (m in months) {
ks_test[[m]] <- ks.test(prec_mes[prec_mes$month==m,they],prec_gen[prec_gen$month==m,they])
}
ks_test
prec_gen[prec_mes$month==m,they]
for (m in months) {
x = prec_mes[prec_mes$month==m,they]
y = prec_gen[prec_mes$month==m,they]
ks_test[[m]] <- ks.test(x,y)
}
View(y)
ks_test <- list()
for (m in months) {
x = prec_mes[prec_mes$month==m,"T45001"]
y = prec_gen[prec_mes$month==m,"T45001"]
ks_test[[m]] <- ks.test(x,y)
}
View(ks_test)
ks_test[[1]]
library(readxl)
FE_and_RE_analysis <- read_excel("FE and RE analysis.xlsx",
sheet = "FE and RE MODELS")
View(FE_and_RE_analysis)
library(plm)
install.packages(plm)
install.packages("plm")
library(plm)
Data_for_Analysis_Panel <- pdata.frame(FE_and_RE_analysis, index = c("TEAM", "Year"))
View(Data_for_Analysis_Panel)
names(Data_for_Analysis_Panel)
library(dplyr)
select(Data_for_Analysis_Panel, TEAM)
RE_FE_Model <- plm(log(Points %) ~ log(Simpson) , data = Data_for_Analysis_Panel)
RE_FE_Model <- plm(log('Points %') ~ log(Simpson) , data = Data_for_Analysis_Panel)
data("Produc")
View(PRECIPITATION)
str(Produc)
str(FE_and_RE_analysis)
FE_and_RE_analysis$TEAM <- factor(FE_and_RE_analysis$TEAM)
FE_and_RE_analysis <- read_excel("FE and RE analysis.xlsx", sheet = "FE and RE MODELS")
str(FE_and_RE_analysis)
# Pre Processing
FE_and_RE_analysis$TEAM <- factor(FE_and_RE_analysis$TEAM)
FE_and_RE_analysis$Cups <- factor(FE_and_RE_analysis$Cups)
FE_and_RE_analysis$`Age^2` <- NULL
Data_for_Analysis_Panel <- pdata.frame(FE_and_RE_analysis, index = c("TEAM", "Year"))
str(Data_for_Analysis_Panel)
RE_FE_Model <- plm(log('Points %') ~ log(Simpson) , data = Data_for_Analysis_Panel)
RE_FE_Model <- plm(log(`Points %`) ~ log(Simpson) , data = Data_for_Analysis_Panel)
RE_FE_Model <- plm(log(`Points %`) ~ log(Simpson) , data = Data_for_Analysis_Panel)
RE_FE_Model <- plm(log(Points %) ~ log(Simpson) , data = Data_for_Analysis_Panel)
names(FE_and_RE_analysis$`Points %`) <- "Points"
Data_for_Analysis_Panel <- pdata.frame(FE_and_RE_analysis, index = c("TEAM", "Year"))
str(Data_for_Analysis_Panel)
names(Data_for_Analysis_Panel)
Data_for_Analysis_Panel <- pdata.frame(FE_and_RE_analysis, index = c("TEAM", "Year"))
str(Data_for_Analysis_Panel)
FE_and_RE_analysis <- read_excel("FE and RE analysis.xlsx", sheet = "FE and RE MODELS")
FE_and_RE_analysis$TEAM <- factor(FE_and_RE_analysis$TEAM)
FE_and_RE_analysis$Cups <- factor(FE_and_RE_analysis$Cups)
FE_and_RE_analysis$`Age^2` <- NULL
Data_for_Analysis_Panel <- pdata.frame(FE_and_RE_analysis, index = c("TEAM", "Year"))
str(Data_for_Analysis_Panel)
RE_FE_Model <- plm(Data_for_Analysis_Panel$`Points %` ~ log(Simpson) , data = Data_for_Analysis_Panel)
RE_FE_Model <- plm(log(Data_for_Analysis_Panel$`Points %`) ~ Data_for_Analysis_Panel$Simpson , data = Data_for_Analysis_Panel,
model = "within")
RE_FE_Model <- plm(log(Data_for_Analysis_Panel$`Points %`) ~ log(Data_for_Analysis_Panel$Simpson) , data = Data_for_Analysis_Panel,
model = "within")
#names(Data_for_Analysis_Panel)
#select(Data_for_Analysis_Panel, TEAM)
summary(FE_and_RE_analysis)
RE_FE_Model <- plm(Data_for_Analysis_Panel$`Points %` ~ Data_for_Analysis_Panel$Simpson , data = Data_for_Analysis_Panel,
model = "within")
Data_for_Analysis_Panel <- plm.data(FE_and_RE_analysis, indexes = c("TEAM", "Year"))
str(Data_for_Analysis_Panel)
RE_FE_Model <- plm(Data_for_Analysis_Panel$`Points %` ~ log(Data_for_Analysis_Panel$Simpson)  , data = Data_for_Analysis_Panel,
model = "within")
RE_FE_Model <- plm(Data_for_Analysis_Panel$`Points %` ~ log(Data_for_Analysis_Panel$Shannon)  , data = Data_for_Analysis_Panel,
model = "within")
RE_FE_Model <- plm(Data_for_Analysis_Panel$`Points %` ~ log(Data_for_Analysis_Panel$Gini)  , data = Data_for_Analysis_Panel,
model = "within")
log(Data_for_Analysis_Panel$Gini)
Data_for_Analysis_Panel$Gini
FE_and_RE_analysis <- read_excel("FE and RE analysis.xlsx",
sheet = "VARIABLES")
str(FE_and_RE_analysis)
FE_and_RE_analysis[101:119, ] <- NULL
FE_and_RE_analysis[101:119] <- NULL
FE_and_RE_analysis[101:119,]
FE_and_RE_analysis[101:119,] <- 0
FE_and_RE_analysis <- read_excel("FE and RE analysis.xlsx",
sheet = "VARIABLES")
View(FE_and_RE_analysis)
summary(FE_and_RE_analysis)
str(FE_and_RE_analysis)
Data_for_Analysis_Panel <- plm.data(FE_and_RE_analysis, indexes = c("TEAM", "Year"))
Data_for_Analysis_Panel <- pdata.frame(FE_and_RE_analysis, index = c("TEAM", "Year"))
str(Data_for_Analysis_Panel)
RE_FE_Model <- plm(log(`Points %`) ~ log(Gini)  , data = Data_for_Analysis_Panel,
model = "within")
RE_FE_Model <- plm(log(Points %) ~ log(Gini)  , data = Data_for_Analysis_Panel,
model = "within")
RE_FE_Model <- plm(log(Data_for_Analysis_Panel$`Points %`) ~ log(Gini)  , data = Data_for_Analysis_Panel,
model = "within")
names(Data_for_Analysis_Panel)
RE_FE_Model <- plm(log(Data_for_Analysis_Panel$`Points %`) ~ log(Gini) + log(Shannon)  , data = Data_for_Analysis_Panel,
model = "within")
RE_FE_Model <- plm(log(Data_for_Analysis_Panel$`Points %`) ~
log(Gini) + log(Shannon) +log(Simpson) + log(Wages) + log(Aristocracy) + log(Age) +
(log(Age))^2 + log(Population) + log(`Expected points %`) + log(Nationality) + Cups,
data = Data_for_Analysis_Panel,
model = "within")
FE_and_RE_analysis <- read_excel("FE and RE analysis.xlsx",
sheet = "VARIABLES")
str(FE_and_RE_analysis)
summary(FE_and_RE_analysis)
# Pre Processing
FE_and_RE_analysis$TEAM <- factor(FE_and_RE_analysis$TEAM)
FE_and_RE_analysis$Cups <- factor(FE_and_RE_analysis$Cups)
Data_for_Analysis_Panel <- pdata.frame(FE_and_RE_analysis, index = c("TEAM", "Year"))
names(Data_for_Analysis_Panel)
RE_FE_Model <- plm(log(Points) ~
log(Gini) + log(Shannon) +log(Simpson) + log(Wages) + log(Aristocracy) + log(Age) +
(log(Age))^2 + log(Population) + log(ExpectedPoints) + log(Nationality) + Cups,
data = Data_for_Analysis_Panel,
model = "within")
FE_Model <- plm(log(Points) ~
log(Gini) + log(Shannon) +log(Simpson) + log(Wages) + log(Aristocracy) + log(Age) +
(log(Age))^2 + log(Population) + log(ExpectedPoints) + log(Nationality) + Cups,
data = Data_for_Analysis_Panel,
model = "within")
FE_Model$
FE_Model
RE_Model <- plm(log(Points) ~
log(Gini) + log(Shannon) +log(Simpson) + log(Wages) + log(Aristocracy) + log(Age) +
(log(Age))^2 + log(Population) + log(ExpectedPoints) + log(Nationality) + Cups,
data = Data_for_Analysis_Panel,
model = "random")
phtest(FE_Model, RE_Model)
FE_and_RE <- read_excel("FE and RE analysis.xlsx",
sheet = "FE and RE MODELS")
#View(FE_and_RE_analysis)
names()
#View(FE_and_RE_analysis)
names(FE_and_RE)
attach(FE_and_RE)
Data_Panel <- pdata.frame(FE_and_RE , index = c("TEAM", "Year"))
#RE_Model <- plm(log(Points) ~
#                 log(Gini) + log(Shannon) +log(Simpson) + log(Wages) + log(Aristocracy) + log(Age) +
#                (log(Age))^2 + log(Population) + log(ExpectedPoints) + log(Nationality) + Cups,
#             data = Data_for_Analysis_Panel,
#            model = "random")
FEModel <- plm(`Points %` ~ Gini + Shannon + Simpson + Wages + Aristocracy + Age + `Age^2` + Population +
`Expected points %` + Nationality + Cups, data =  FE_and_RE, model = "within")
REModel <- plm(`Points %` ~ Gini + Shannon + Simpson + Wages + Aristocracy + Age + `Age^2` + Population +
`Expected points %` + Nationality + Cups, data =  FE_and_RE, model = "random")
phtest(FEModel, REModel)
detach(FE_and_RE)
FE_and_RE_analysis <- read_excel("FE and RE analysis.xlsx",
sheet = "VARIABLES")
Data_for_Analysis_Panel <- pdata.frame(FE_and_RE_analysis, index = c("TEAM", "Year"))
names(Data_for_Analysis_Panel)
summary(FE_and_RE_analysis)
attach(Data_for_Analysis_Panel)
FE_Model <- plm(log(`Points %`) ~
log(Gini) + log(Shannon) +log(Simpson) + log(Wages) + log(Aristocracy) + log(Age) +
(log(Age))^2 + log(Population) + log(`Expected points %`) + log(Nationality) + Cups,
data = Data_for_Analysis_Panel,
model = "within")
RE_Model <- plm(log(`Points %`) ~
log(Gini) + log(Shannon) +log(Simpson) + log(Wages) + log(Aristocracy) + log(Age) +
(log(Age))^2 + log(Population) + log(`Expected points %`) + log(Nationality) + Cups,
data = Data_for_Analysis_Panel,
model = "random")
phtest(FE_Model, RE_Model)
phtest(FEModel, REModel)
detach(Data_for_Analysis_Panel)
waldtest(FEModel, REModel)
install.packages("plm")
library(readxl)
library(plm)
FE_and_RE_analysis <- read_excel("FE and RE analysis.xlsx",
sheet = "VARIABLES")
Data_for_Analysis_Panel <- pdata.frame(FE_and_RE_analysis, index = c("TEAM", "Year"))
names(Data_for_Analysis_Panel)
#install.packages("plm")
library(readxl)
library(plm)
#---- Using Sheet VARIABLES ----
FE_and_RE_analysis <- read_excel("FE and RE analysis.xlsx",
sheet = "VARIABLES")
Data_for_Analysis_Panel <- pdata.frame(FE_and_RE_analysis, index = c("TEAM", "Year"))
names(Data_for_Analysis_Panel)
attach(Data_for_Analysis_Panel)
FE_Model <- plm(log(`Points %`) ~
log(Gini) + log(Shannon) +log(Simpson) + log(Wages) + log(Aristocracy) + log(Age) +
(log(Age))^2 + log(Population) + log(`Expected points %`) + log(Nationality) + Cups,
data = Data_for_Analysis_Panel,
model = "within")
RE_Model <- plm(log(`Points %`) ~
log(Gini) + log(Shannon) +log(Simpson) + log(Wages) + log(Aristocracy) + log(Age) +
(log(Age))^2 + log(Population) + log(`Expected points %`) + log(Nationality) + Cups,
data = Data_for_Analysis_Panel,
model = "random")
phtest(FE_Model, RE_Model)
waldtest(FE_Model, RE_Model)
detach(Data_for_Analysis_Panel)
#---- Using Sheet FE and RE MODELS ----
library(readxl)
FE_and_RE <- read_excel("FE and RE analysis.xlsx",
sheet = "FE and RE MODELS")
#View(FE_and_RE_analysis)
names(FE_and_RE)
attach(FE_and_RE)
Data_Panel <- pdata.frame(FE_and_RE , index = c("TEAM", "Year"))
FEModel <- plm(`Points %` ~ Gini + Shannon + Simpson + Wages + Aristocracy + Age + `Age^2` + Population +
`Expected points %` + Nationality + Cups, data =  FE_and_RE, model = "within")
REModel <- plm(`Points %` ~ Gini + Shannon + Simpson + Wages + Aristocracy + Age + `Age^2` + Population +
`Expected points %` + Nationality + Cups, data =  FE_and_RE, model = "random")
# Tests
phtest(FEModel, REModel)
waldtest(FEModel, REModel)
detach(FE_and_RE)
waldtest(FEModel, REModel)
library(lmtest)
waldtest(FE_Model, RE_Model)
#install.packages("plm")
library(readxl)
library(plm)
library(lmtest)
#---- Using Sheet VARIABLES ----
FE_and_RE_analysis <- read_excel("FE and RE analysis.xlsx",
sheet = "VARIABLES")
Data_for_Analysis_Panel <- pdata.frame(FE_and_RE_analysis, index = c("TEAM", "Year"))
names(Data_for_Analysis_Panel)
attach(Data_for_Analysis_Panel)
FE_Model <- plm(log(`Points %`) ~ log(Wages) + log(Aristocracy) + log(Age) +
(log(Age))^2 + log(Population) + log(`Expected points %`) + log(Nationality) + Cups,
data = Data_for_Analysis_Panel,
model = "within")
FE_Model
FE_Model_Gini <- plm(log(`Points %`) ~
log(Gini) + log(Wages) + log(Aristocracy) + log(Age) +
(log(Age))^2 + log(Population) + log(`Expected points %`) + log(Nationality) + Cups,
data = Data_for_Analysis_Panel,
model = "within")
FE_Model_Gini
FE_Model_Shannon <- plm(log(`Points %`) ~
log(Shannon) + log(Wages) + log(Aristocracy) + log(Age) +
(log(Age))^2 + log(Population) + log(`Expected points %`) + log(Nationality) + Cups,
data = Data_for_Analysis_Panel,
model = "within")
FE_Model_Shannon
FE_Model_Simpson <- plm(log(`Points %`) ~
log(Simpson) + log(Wages) + log(Aristocracy) + log(Age) +
(log(Age))^2 + log(Population) + log(`Expected points %`) + log(Nationality) + Cups,
data = Data_for_Analysis_Panel,
model = "within")
FE_Model_Simpson
RE_Model <- plm(log(`Points %`) ~
log(Wages) + log(Aristocracy) + log(Age) +
(log(Age))^2 + log(Population) + log(`Expected points %`) + log(Nationality) + Cups,
data = Data_for_Analysis_Panel,
model = "random")
RE_Model
RE_Model_Gini <- plm(log(`Points %`) ~
log(Gini) + log(Wages) + log(Aristocracy) + log(Age) +
(log(Age))^2 + log(Population) + log(`Expected points %`) + log(Nationality) + Cups,
data = Data_for_Analysis_Panel,
model = "random")
RE_Model_Gini
RE_Model_Shannon <- plm(log(`Points %`) ~
log(Shannon)  + log(Wages) + log(Aristocracy) + log(Age) +
(log(Age))^2 + log(Population) + log(`Expected points %`) + log(Nationality) + Cups,
data = Data_for_Analysis_Panel,
model = "random")
RE_Model_Shannon
RE_Model_Simpson <- plm(log(`Points %`) ~ log(Simpson) + log(Wages) + log(Aristocracy) + log(Age) +
(log(Age))^2 + log(Population) + log(`Expected points %`) + log(Nationality) + Cups,
data = Data_for_Analysis_Panel,
model = "random")
RE_Model_Simpson
phtest(FE_Model, RE_Model)
phtest(FE_Model_Gini, RE_Model_Gini)
phtest(FE_Model_Shannon, RE_Model_Shannon)
phtest(FE_Model_Simpson, RE_Model_Simpson)
waldtest(FE_Model, RE_Model)
waldtest(FE_Model_Gini, RE_Model_Gini)
waldtest(FE_Model_Shannon, RE_Model_Shannon)
waldtest(FE_Model_Simpson, RE_Model_Simpson)
detach(Data_for_Analysis_Panel)

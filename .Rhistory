<<<<<<< HEAD
obs_multisite <- prec_mes[,station]>=valmin
#
gen_multisite <- generate(model_multisite,exogen=exogen,origin=origin,end=end)
#
gen_multisite_logit <- generate(model_multisite_logit,exogen=exogen,origin=origin,end=end)
#amount
precamount <- PrecipitationAmountModel(prec_mes,station=station,origin=origin)
val <- predict(precamount)
prec_gen <- generate(precamount)
month <- adddate(as.data.frame(residuals(precamount[[1]])),origin=origin)$month
plot(factor(month),residuals(precamount[[1]]))
qqplot(prec_mes[,station[1]],prec_gen[[1]])
abline(0,1)
library(RMAWGEN)
load('BullooModInp.RData')
TX_CLIMATE <- NULL
TN_CLIMATE <- NULL
PREC_CLIMATE <- NULL
# Calibration period
year_max <- 2018
year_min <- 1961
origin <- "1961-1-1"
station <- c("T36133", "T36137", "T44040", "T44120", "T45000", "T45001", "T45002", "T45003", "T45004", "T45007")
names(ELEVATION) <- STATION_NAMES
names(LOCATION) <- STATION_NAMES
ELEVATION[station]
LOCATION[station]
n_GPCA_iter <- 5
n_GPCA_iteration_residuals <- 5
p_test <- 1
p_prec <- 3
exogen <- NULL
exogen_sim <- exogen
generationP03GPCA_prec <- ComprehensivePrecipitationGenerator(station=station,
prec_all=PRECIPITATION,
year_min=year_min,
year_max=year_max,
p=p_prec,
n_GPCA_iteration=n_GPCA_iter,
n_GPCA_iteration_residuals=n_GPCA_iteration_residuals,
exogen=exogen,
exogen_sim=exogen_sim,
sample="monthly",
mean_climate_prec=PREC_CLIMATE,
no_spline=FALSE)
# ---- Percipitation ----
rm(list = ls())
library(RMAWGEN)
# ---- Percipitation ----
rm(list = ls())
load('BullooModInp.RData')
TX_CLIMATE <- NULL
TN_CLIMATE <- NULL
PREC_CLIMATE <- NULL
# Calibration period
year_max <- 2018
year_min <- 1989
origin <- "1961-1-1"
station <- c("T36133", "T36137", "T44040", "T44120", "T45000", "T45001", "T45002", "T45003", "T45004", "T45007")
names(ELEVATION) <- STATION_NAMES
names(LOCATION) <- STATION_NAMES
ELEVATION[station]
LOCATION[station]
n_GPCA_iter <- 5
n_GPCA_iteration_residuals <- 5
p_test <- 1
p_prec <- 3
exogen <- NULL
exogen_sim <- exogen
generationP03GPCA_prec <- ComprehensivePrecipitationGenerator(station=station,
prec_all=PRECIPITATION,
year_min=year_min,
year_max=year_max,
p=p_prec,
n_GPCA_iteration=n_GPCA_iter,
n_GPCA_iteration_residuals=n_GPCA_iteration_residuals,
exogen=exogen,
exogen_sim=exogen_sim,
sample="monthly",
mean_climate_prec=PREC_CLIMATE,
no_spline=FALSE)
generationP01GPCA_prec <- ComprehensivePrecipitationGenerator(station=station,
prec_all=PRECIPITATION,
year_min=year_min,
year_max=year_max,
p=p_test,
n_GPCA_iteration=n_GPCA_iter,
n_GPCA_iteration_residuals=n_GPCA_iteration_residuals,
exogen=exogen,
exogen_sim=exogen_sim,
sample="monthly",
mean_climate_prec=PREC_CLIMATE,
no_spline=FALSE)
generationP03_prec <- ComprehensivePrecipitationGenerator(station=station,
prec_all=PRECIPITATION,
year_min=year_min,
year_max=year_max,
p=p_prec,
n_GPCA_iteration=0,
n_GPCA_iteration_residuals=0,
exogen=exogen,
exogen_sim=exogen_sim,
sample="monthly",
mean_climate_prec=PREC_CLIMATE,
no_spline=FALSE)
origin <- "1989-1-1"
generationP01_prec <- ComprehensivePrecipitationGenerator(station=station,
prec_all=PRECIPITATION,
year_min=year_min,
year_max=year_max,
p=p_test,
n_GPCA_iteration=0,
n_GPCA_iteration_residuals=0,
exogen=exogen,
exogen_sim=exogen_sim,
sample="monthly",
mean_climate_prec=PREC_CLIMATE,
no_spline=FALSE)
VARselect(generationP03_prec$data_prec,lag.max=20)
VARselect(generationP03GPCA_prec$var@GPCA_data$final_results,lag.max=20)
normality_test(generationP01_prec$var)
normality_test(generationP03_prec$var)
normality_test(generationP01GPCA_prec$var)
normality_test(generationP03GPCA_prec$var)
serial_test(generationP01_prec$var)
serial_test(generationP03_prec$var)
serial_test(generationP01GPCA_prec$var)
serial_test(generationP03GPCA_prec$var)
# Collecting the measured and generated time series
prec_mes <- generationP01_prec$prec_mes
prec_gen <- list(P03GPCA=generationP03GPCA_prec$prec_gen,
P01GPCA=generationP01GPCA_prec$prec_gen,
P03=generationP03GPCA_prec$prec_gen,
P01=generationP01GPCA_prec$prec_gen)
NDAY <- nrow(prec_mes)
days <- list()
days$DJF <-  extractmonths(data=1:NDAY,when=c("Dec","Jan","Feb"),origin=origin)
days$MAM <- extractmonths(data=1:NDAY,when=c("Mar","Apr","May"),origin=origin)
days$JJA <- extractmonths(data=1:NDAY,when=c("Jun","Jul","Aug"),origin=origin)
days$SON <- extractmonths(data=1:NDAY,when=c("Sep","Oct","Nov"),origin=origin)
days
# SET THE CORRECT PATH WHERE TO PLOT THE FIGURES
wpath <- getwd()
CEX <- 1.4
station00 <- station <- c("T36133", "T36137", "T44040", "T44120", "T45000", "T45001",
"T45002", "T45003", "T45004", "T45007")
for (stat in station00){
print(stat)
for (it in names(days)) {
str(it)
name <- it
season <- days[[it]]
lag <- 1
pdf_prec <- paste(wpath,"/QQpLots/",stat,"prec_qqplot_",lag,"_",year_min,"_",year_max,"_",it,".pdf",sep="")
main_prec  <- paste(names(prec_gen),stat,'lag',lag,"days",it,sep=" ")
Rangex <- range(prec_mes[season,])
Rangey <- range(c(prec_gen[[1]][season,],prec_gen[[2]][season,],prec_gen[[3]][season,],prec_gen[[4]][season,]))
XLim <- YLim  <- c(min(c(Rangex,Rangey)),max(c(Rangex,Rangey)))
qqplot_RMAWGEN_prec(prec_mes=prec_mes,prec_gen=prec_gen,main=main_prec,station=stat,when=season,pdf=pdf_prec,
lag=lag,cex.main=CEX,cex.lab=CEX,cex.axis=CEX,xlim=XLim,ylim=YLim,cex=1.2)
=======
ks_test_T36133 <- list()
ks_test_T36137 <- list()
ks_test_T44040 <- list()
ks_test_T44120 <- list()
ks_test_T45000 <- list()
ks_test_T45001 <- list()
ks_test_T45002 <- list()
ks_test_T45003 <- list()
ks_test_T45004 <- list()
ks_test_T45007 <- list()
for (m in months) {
ks_test_T36133[[m]] <- ks.test(prec_mes[prec_mes$month==m,"T36133"],prec_gen[prec_mes$month==m,"T36133"])
>>>>>>> 318afc7e9a0fc68899e2ecf3a8aaabab5239f6a6
}
for (m in months) {
ks_test_T36137[[m]] <- ks.test(prec_mes[prec_mes$month==m,"T36137"],prec_gen[prec_mes$month==m,"T36137"])
}
for (m in months) {
ks_test_T44040[[m]] <- ks.test(prec_mes[prec_mes$month==m,"T44040"]
,prec_gen[prec_mes$month==m,"T44040"])
}
for (m in months) {
ks_test_T44120[[m]] <- ks.test(prec_mes[prec_mes$month==m,"T44120"],
prec_gen[prec_mes$month==m,"T44120"]
)
}
for (m in months) {
ks_test_T45000[[m]] <- ks.test(prec_mes[prec_mes$month==m,"T45000"],
prec_gen[prec_mes$month==m,"T45000"]
)
}
for (m in months) {
ks_test_T45001[[m]] <- ks.test(prec_mes[prec_mes$month==m,"T45001"],
prec_gen[prec_mes$month==m,"T45001"]
)
}
for (m in months) {
ks_test_T45002[[m]] <- ks.test(prec_mes[prec_mes$month==m,"T45002"],
prec_gen[prec_mes$month==m,"T45002"]
)
}
for (m in months) {
ks_test_T45003[[m]] <- ks.test(prec_mes[prec_mes$month==m,"T45003"],
prec_gen[prec_mes$month==m,"T45003"]
)
}
for (m in months) {
ks_test_T45004[[m]] <- ks.test(prec_mes[prec_mes$month==m,"T45004"],
prec_gen[prec_mes$month==m,"T45004"])
}
for (m in months) {
ks_test_T45007[[m]] <- ks.test(prec_mes[prec_mes$month==m,"T45007"],
prec_gen[prec_mes$month==m,"T45007"])
}
ks_test_T36133
ks_test_T36137
ks_test_T44040
ks_test_T44120
ks_test_T45000
ks_test_T45001
ks_test_T45002
ks_test_T45003
ks_test_T45004
ks_test_T45007
cc_mes <- CCGamma(prec_mes[,they],sample = "monthly",origin = origin)
str(cc_mes)
str(cc_gen)
cc_gen <- CCGamma(prec_gen[,they],sample = "monthly",origin = origin)
str(cc_gen)
#  spatial statistical correlation between observed and generated time series
str(prec_mes[,they])
cc_mes
ks_test_T45007
for (m in months) {
ks_test_T36133[[m]] <- ks.test(prec_mes[prec_mes$month==m,c("T36133", "T36137", "T44040")],
prec_gen[prec_mes$month==m,c("T36133", "T36137", "T44040")])
}
for (m in months) {
ks_test_T36133[[m]] <- ks.test(prec_mes[prec_mes$month==m,c("T36133", "T36137")],
prec_gen[prec_mes$month==m,c("T36133", "T36137")])
}
ks_test_T36133[[m]] <- ks.test(prec_mes[prec_mes$month==m,c("T36133")],
prec_gen[prec_mes$month==m,c("T36133")])
for (m in months) {
ks_test_T36133[[m]] <- ks.test(prec_mes[prec_mes$month==m,c("T36133")],
prec_gen[prec_mes$month==m,c("T36133")])
}
for (m in months) {
ks_test_T36133[[m]] <- ks.test(prec_mes[prec_mes$month==m, y = c("T36133")],
prec_gen[prec_mes$month==m, y = c("T36133")])
}
for (m in months) {
ks_test_T36133[[m]] <- ks.test(prec_mes[prec_mes$month==m,"T36133"],
prec_gen[prec_mes$month==m,"T36133"])
}
cc_mes
#
for (m in 1:12){
cc_mes$m$nooccurrence_correlation
}
CC_Mes <-  cc_mes$m$nooccurrence_correlation
CC_Mes
CC_Mes <-  cc_mes$nooccurrence_correlation
cc_mes$nooccurrence_correlation
#
cc_mes$`1`$nooccurrence_correlationn
#
cc_mes$`1`$nooccurrence_correlation
cc_mes$`12`$nooccurrence_correlation
cc_mes$`1`$nooccurrence_correlation
cc_mes$`2`$nooccurrence_correlation
cc_mes$`3`$nooccurrence_correlation
cc_mes$`4`$nooccurrence_correlation
cc_mes$`5`$nooccurrence_correlation
cc_mes$`6`$nooccurrence_correlation
cc_mes$`7`$nooccurrence_correlation
cc_mes$`8`$nooccurrence_correlation
cc_mes$`9`$nooccurrence_correlation
cc_mes$`10`$nooccurrence_correlation
cc_mes$`11`$nooccurrence_correlation
cc_mes$`12`$nooccurrence_correlation
cc_gen$`12`$nooccurrence_correlation
cc_gen$`1`$nooccurrence_correlation
cc_gen$`2`$nooccurrence_correlation
cc_gen$`3`$nooccurrence_correlation
cc_gen$`4`$nooccurrence_correlation
cc_gen$`5`$nooccurrence_correlation
cc_gen$`6`$nooccurrence_correlation
cc_gen$`7`$nooccurrence_correlation
cc_gen$`8`$nooccurrence_correlation
cc_gen$`9`$nooccurrence_correlation
cc_gen$`10`$nooccurrence_correlation
cc_gen$`11`$nooccurrence_correlation
cc_gen$`12`$nooccurrence_correlation
df <- data.frame(obs=prec_mes[,they],gen=prec_gen1[,they])
# Modifying Precipitation Distribution (e.g. Precipitation Futture Projection)
exogen <- exogen
months <- factor(prec_mes$month)
set.seed(1235)
prec_gen1_occ <- generate(model1,exogen=exogen,monthly.factor=months,n=length(months))
df <- data.frame(obs=prec_mes[,they],gen=prec_gen[,they])
df
df$date <- as.Date(origin)+days(1:nrow(df))-1
df$month <- factor(month(df$date))
df$season <- "none"
df$season[df$month %in% c(12,2,1)] <- "1.DJF"
df$season[df$month %in% c(3,4,5)] <-  "2.MAM"
df$season[df$month %in% c(6,7,8)] <-  "3.JJA"
df$season[df$month %in% c(9,10,11)] <-  "4.SON"
dfp <- df[df$obs>valmin,]
View(dfp)
View(df)
valmin
df <- data.frame(obs=prec_mes[,they],gen=prec_gen[,they])
View(df)
obs=prec_mes[,they]
View(obs)
df <- data.frame(obs=prec_mes[,they],gen=prec_gen[,they])
df$date <- as.Date(origin)+days(1:nrow(df))-1
df$month <- factor(month(df$date))
df$season <- "none"
df$season[df$month %in% c(12,2,1)] <- "1.DJF"
df$season[df$month %in% c(3,4,5)] <-  "2.MAM"
df$season[df$month %in% c(6,7,8)] <-  "3.JJA"
df$season[df$month %in% c(9,10,11)] <-  "4.SON"
df_T36133 <- df[df$obs.T36133>valmin,]
View(df_T36133)
df_T36133 <- df[df$obs.T36133>valmin,1]
df_T36133 <- df[df$obs.T36133>valmin]
df <- data.frame(obs=prec_mes[,they],gen=prec_gen[,they])
df$date <- as.Date(origin)+days(1:nrow(df))-1
df$month <- factor(month(df$date))
df$season <- "none"
df$season[df$month %in% c(12,2,1)] <- "1.DJF"
df$season[df$month %in% c(3,4,5)] <-  "2.MAM"
df$season[df$month %in% c(6,7,8)] <-  "3.JJA"
df$season[df$month %in% c(9,10,11)] <-  "4.SON"
df_T36133 <- df[df$obs.T36133>valmin]
df_T36133 <- df[df$obs.T36133>valmin,]
color_month <-  rep(c("#E6352F","#34A74B","#3D79F3" ),4)[c(12,1:11)]
color_month
View(df_T36133)
names(df)
df_T36133 <- df[df$obs.T36133>valmin, c("obs.T36133","gen.T36133","date","month", "season")]
color_month <-  rep(c("#E6352F","#34A74B","#3D79F3" ),4)[c(12,1:11)]
gdens <- ggplot(data=df_T36133)+
geom_density(aes(x=obs,color=month,group=month),trim=TRUE)+facet_grid(season ~ .)+theme_bw()
gdens <- gdens+scale_color_manual(values = color_month)
show(gdens)
gdens <- ggplot(data=df_T36133)+
geom_density(aes(x=obs,color=month,group=month),trim=TRUE)+
facet_grid(season ~ month)+
theme_bw()
gdens <- gdens+scale_color_manual(values = color_month)
show(gdens)
gdens <- ggplot(data=df_T36133)+
geom_density(aes(x=obs,color=month,group=month))+
facet_grid(season ~ month)+
theme_bw()
gdens <- gdens+scale_color_manual(values = color_month)
show(gdens)
gdens <- ggplot(data=df_T36133)+
geom_density(aes(x=obs.T36133,color=month,group=month),trim=TRUE)+
facet_grid(season ~ .)+
theme_bw()
gdens <- gdens+scale_color_manual(values = color_month)
show(gdens)
gdens <- ggplot(data=df_T36133)+
geom_density(aes(x=obs.T36133,color=month,group=month),trim=TRUE)+
facet_grid(season ~ .)+
theme_bw() +
scale_color_manual(values = color_month)
show(gdens)
names(df)
df_T36133 <- df[df$obs.T36133>valmin, c("obs.T36133","gen.T36133","date","month", "season")]
color_month <-  rep(c("#E6352F","#34A74B","#3D79F3" ),4)[c(12,1:11)]
gdens_T36133 <- ggplot(data=df_T36133)+
geom_density(aes(x=obs.T36133,color=month,group=month),trim=TRUE)+
facet_grid(season ~ .)+
theme_bw() +
scale_color_manual(values = color_month)
save("gdens_T36133.png")
gdens_T36133 <- ggplot(data=df_T36133)+
geom_density(aes(x=obs.T36133,color=month,group=month),trim=TRUE)+
facet_grid(season ~ .)+
theme_bw() +
scale_color_manual(values = color_month)
save("gdens_T36133.png")
gdens_T36133 <- ggplot(data=df_T36133)+
geom_density(aes(x=obs.T36133,color=month,group=month),trim=TRUE)+
facet_grid(season ~ .)+
theme_bw() +
scale_color_manual(values = color_month)
ggsave("gdens_T36133.png")
# ---- station T36137
df_obs.T36137 <- df[df$obs.T36137>valmin, c("obs.T36137","gen.T36133","date","month", "season")]
color_month <-  rep(c("#E6352F","#34A74B","#3D79F3" ),4)[c(12,1:11)]
gdens_obs.T36137 <- ggplot(data=df_obs.T36137)+
geom_density(aes(x=obs.T36133,color=month,group=month),trim=TRUE)+
facet_grid(season ~ .)+
theme_bw() +
scale_color_manual(values = color_month)
ggsave("gdens_T36133.png")
#ggsave("gdens_T36133.png")
show(gdens_obs.T36137)
# ---- station T36137
df_obs.T36137 <- df[df$obs.T36137>valmin, c("obs.T36137","gen.T36133","date","month", "season")]
color_month <-  rep(c("#E6352F","#34A74B","#3D79F3" ),4)[c(12,1:11)]
gdens_obs.T36137 <- ggplot(data=df_obs.T36137)+
geom_density(aes(x=obs.T36137,color=month,group=month),trim=TRUE)+
facet_grid(season ~ .)+
theme_bw() +
scale_color_manual(values = color_month)
#ggsave("gdens_T36133.png")
show(gdens_obs.T36137)
ggsave("gdens_T36133.png")
df_obs.T44040 <- df[df$obs.T44040>valmin, c("obs.T44040","gen.T36133","date","month", "season")]
color_month <-  rep(c("#E6352F","#34A74B","#3D79F3" ),4)[c(12,1:11)]
gdens_obs.T44040 <- ggplot(data=df_obs.T44040)+
geom_density(aes(x=obs.T44040,color=month,group=month),trim=TRUE)+
facet_grid(season ~ .)+
theme_bw() +
scale_color_manual(values = color_month)
show(gdens_obs.T44040)
ggsave("gdens_T44040.png")
df_T36133 <- df[df$obs.T36133>valmin, c("obs.T36133","date","month", "season")]
color_month <-  rep(c("#E6352F","#34A74B","#3D79F3" ),4)[c(12,1:11)]
gdens_T36133 <- ggplot(data=df_T36133)+
geom_density(aes(x=obs.T36133,color=month,group=month),trim=TRUE)+
facet_grid(season ~ .)+
theme_bw() +
scale_color_manual(values = color_month)
ggsave("gdens_T36133.png")
show(gdens_T36133)
# ---- station T36137
df_obs.T36137 <- df[df$obs.T36137>valmin, c("obs.T36137","date","month", "season")]
color_month <-  rep(c("#E6352F","#34A74B","#3D79F3" ),4)[c(12,1:11)]
gdens_obs.T36137 <- ggplot(data=df_obs.T36137)+
geom_density(aes(x=obs.T36137,color=month,group=month),trim=TRUE)+
facet_grid(season ~ .)+
theme_bw() +
scale_color_manual(values = color_month)
ggsave("gdens_T36133.png")
show(gdens_obs.T36137)
df_obs.T44040 <- df[df$obs.T44040>valmin, c("obs.T44040","date","month", "season")]
color_month <-  rep(c("#E6352F","#34A74B","#3D79F3" ),4)[c(12,1:11)]
gdens_obs.T44040 <- ggplot(data=df_obs.T44040)+
geom_density(aes(x=obs.T44040,color=month,group=month),trim=TRUE)+
facet_grid(season ~ .)+
theme_bw() +
scale_color_manual(values = color_month)
ggsave("gdens_T44040.png")
show(gdens_obs.T44040)
df_obs.T44120 <- df[df$obs.T44120>valmin, c("obs.T44120","date","month", "season")]
color_month <-  rep(c("#E6352F","#34A74B","#3D79F3" ),4)[c(12,1:11)]
gdens_obs.T44120 <- ggplot(data=df_obs.T44120)+
geom_density(aes(x=obs.T44120,color=month,group=month),trim=TRUE)+
facet_grid(season ~ .)+
theme_bw() +
scale_color_manual(values = color_month)
ggsave("gdens_T44120.png")
show(gdens_obs.T44120)
df_obs.T45000 <- df[df$obs.T45000>valmin, c("obs.T45000","date","month", "season")]
color_month <-  rep(c("#E6352F","#34A74B","#3D79F3" ),4)[c(12,1:11)]
gdens_obs.T45000 <- ggplot(data=df_obs.T45000)+
geom_density(aes(x=obs.T45000,color=month,group=month),trim=TRUE)+
facet_grid(season ~ .)+
theme_bw() +
scale_color_manual(values = color_month)
ggsave("gdens_T45000.png")
show(gdens_obs.T45000)
df_obs.T45001 <- df[df$obs.T45001>valmin, c("obs.T45001","date","month", "season")]
color_month <-  rep(c("#E6352F","#34A74B","#3D79F3" ),4)[c(12,1:11)]
gdens_obs.T45001 <- ggplot(data=df_obs.T45001)+
geom_density(aes(x=obs.T45001,color=month,group=month),trim=TRUE)+
facet_grid(season ~ .)+
theme_bw() +
scale_color_manual(values = color_month)
ggsave("gdens_T45001.png")
show(gdens_obs.T45001)
# ---- station T45002
df_obs.T45002 <- df[df$obs.T45002>valmin, c("obs.T45002","date","month", "season")]
color_month <-  rep(c("#E6352F","#34A74B","#3D79F3" ),4)[c(12,1:11)]
gdens_obs.T45002 <- ggplot(data=df_obs.T45002)+
geom_density(aes(x=obs.T45002,color=month,group=month),trim=TRUE)+
facet_grid(season ~ .)+
theme_bw() +
scale_color_manual(values = color_month)
ggsave("gdens_T45002.png")
show(gdens_obs.T45002)
# ---- station T45003
df_obs.T45003 <- df[df$obs.T45003>valmin, c("obs.T45003","date","month", "season")]
color_month <-  rep(c("#E6352F","#34A74B","#3D79F3" ),4)[c(12,1:11)]
gdens_obs.T45003 <- ggplot(data=df_obs.T45003)+
geom_density(aes(x=obs.T45003,color=month,group=month),trim=TRUE)+
facet_grid(season ~ .)+
theme_bw() +
scale_color_manual(values = color_month)
ggsave("gdens_T45003.png")
show(gdens_obs.T45003)
T45003
# ---- station T45004
df_obs.T45004 <- df[df$obs.T45004>valmin, c("obs.T45004","date","month", "season")]
color_month <-  rep(c("#E6352F","#34A74B","#3D79F3" ),4)[c(12,1:11)]
gdens_obs.T45004 <- ggplot(data=df_obs.T45004)+
geom_density(aes(x=obs.T45004,color=month,group=month),trim=TRUE)+
facet_grid(season ~ .)+
theme_bw() +
scale_color_manual(values = color_month)
ggsave("gdens_T45004.png")
show(gdens_obs.T45004)
# ---- station T45007
df_obs.T45007 <- df[df$obs.T45007>valmin, c("obs.T45007","date","month", "season")]
color_month <-  rep(c("#E6352F","#34A74B","#3D79F3" ),4)[c(12,1:11)]
gdens_obs.T45007 <- ggplot(data=df_obs.T45007)+
geom_density(aes(x=obs.T45007,color=month,group=month),trim=TRUE)+
facet_grid(season ~ .)+
theme_bw() +
scale_color_manual(values = color_month)
ggsave("gdens_T45007.png")
show(gdens_obs.T45007)
library(lmom)
install.packages(lmom)
install.packages("lmom")
library(lmom)
prec_val_m_T36137 <- df_obs.T36137$obs.T36137 %>% split(df_obs.T36137$month)
lmoms <- prec_val_m_T36137 %>% lapply(FUN=samlmu)
params <- lmoms %>% lapply(FUN=pelln3,bound=valmin)
kstest <-params %>% mapply(FUN=ks.test,x=prec_val_m,y="cdfln3",SIMPLIFY=FALSE)
kstest <-params %>% mapply(FUN=ks.test,x=prec_val_m_T36137,y="cdfln3",SIMPLIFY=FALSE)
kstest
library(readr)
Monthy_close_prices <- read_csv("~/Downloads/Monthy close prices of S_P.csv")
Monthy_close_prices <- read_csv("C:/Users/Faizan Ahmed/Downloads/Downloads/Monthy close prices of S_P.csv")
Monthy_close_prices <- read_csv("C:/Users/Faizan Ahmed/Downloads/Monthy close prices of S_P.csv")
Monthy <- data.frame(Monthy_close_prices$Date, Monthy_close_prices$`Adj Close`)
names(Monthy) <-  c("Date","Return")
library(dplyr)
library(tidyverse)
Monthy <- Monthy %>% mutate(Month = strftime(Monthy$Date, "%m"),
D1 = ifelse(Month == "01", 1,0),
D2 = ifelse(Month == "02", 1,0),
D3 = ifelse(Month == "03", 1,0),
D4 = ifelse(Month == "04", 1,0),
D5 = ifelse(Month == "05", 1,0),
D6 = ifelse(Month == "06", 1,0),
D7 = ifelse(Month == "07", 1,0),
D8 = ifelse(Month == "08", 1,0),
D9 = ifelse(Month == "09", 1,0),
D10 = ifelse(Month == "10", 1,0),
D11 = ifelse(Month == "11", 1,0),
D12 = ifelse(Month == "12", 1,0)) %>%
select(-Date, -Month)
for (i in Monthy$Return){
Monthy$Price <- Monthy$Return[i] / Monthy$Return[i-1]
}
View(Monthy)
View(Monthy)
for (i in  1:nrow(Monthy$Return)){
Monthy$Price <- Monthy$Return[i] / Monthy$Return[i-1]
}
nrow(Monthy$Return)
nrow(Monthy)
for (i in  1:nrow(Monthy)){
Monthy$Price <- Monthy$Return[i] / Monthy$Return[i-1]
}
for (i in  1:nrow(Monthy)){
Monthy$Price = Monthy$Return[i] / Monthy$Return[i-1]
}
1:nrow(Monthy)
for (i in  1:nrow(Monthy)){
Monthy$Price = Monthy$Return[i] / Monthy$Return[i-1]
}
Monthy$Price <-  NULL
for (i in  1:nrow(Monthy)){
Monthy$Price = Monthy$Return[i] / Monthy$Return[i-1]
}
Monthy$Price <-  NULL
for (i in  1:nrow(Monthy)){
Monthy$Price[i] = (Monthy$Return[i] / Monthy$Return[i-1])
}
str(Monthy)
Monthy$Return[1]
Monthy$Return[1] / Monthy$Return[0]
log(Monthy$Return[1] / Monthy$Return[0])
log(Monthy$Return[2] / Monthy$Return[1])
library(readr)
New_excel <- read_csv("C:/Users/Faizan Ahmed/Downloads/New excel.csv")
View(New_excel)
Monthy$Price <-  NULL
for (i in  2:nrow(Monthy)){
Monthy$Price[i] = log(Monthy$Return[2] / Monthy$Return[1])
}
Monthy$Price <-  NULL
for (i in  2:nrow(Monthy)){
Monthy$Price[i] = log(Monthy$Return[i] / Monthy$Return[i-1])
}
for (i in  2:nrow(Monthy)){
Price[i] = log(Monthy$Return[i] / Monthy$Return[i-1])
}
Price <-  NULL
for (i in  2:nrow(Monthy)){
Price[i] = log(Monthy$Return[i] / Monthy$Return[i-1])
}
length(Price)
nrow(Monthy)
Monthy <- Monthy %>% mutate(Price = log(Price))
Monthy$Price <- Price
Monthy$Return <- NULL
summary(Monthy)
Model <- lm(Price ~ ., data = Stock_Return)
na.omit(Monthy)
Monthy <- na.omit(Monthy)
Model <- lm(Price ~ ., data = Monthy)
summary(Model)
Model <- lm(Price ~ D12, data = Monthy)
summary(Model)
Monthy <- Monthy %>% mutate(Month = strftime(Monthy$Date, "%m"),
D1 = ifelse(Month == "01", 1,0),
D2 = ifelse(Month == "02", 1,0),
D3 = ifelse(Month == "03", 1,0),
D4 = ifelse(Month == "04", 1,0),
D5 = ifelse(Month == "05", 1,0),
D6 = ifelse(Month == "06", 1,0),
D7 = ifelse(Month == "07", 1,0),
D8 = ifelse(Month == "08", 1,0),
D9 = ifelse(Month == "09", 1,0),
D10 = ifelse(Month == "10", 1,0),
D11 = ifelse(Month == "11", 1,0),
D12 = ifelse(Month == "12", 1,0)) %>%
select(-Date, -Month)
library(readr)
Monthy_close_prices <- read_csv("C:/Users/Faizan Ahmed/Downloads/Monthy close prices of S_P.csv")
View(Monthy_close_prices)
Monthy <- data.frame(Monthy_close_prices$Date, Monthy_close_prices$`Adj Close`)
names(Monthy) <-  c("Date","Return")
library(dplyr)
library(tidyverse)
Monthy <- Monthy %>% mutate(Month = strftime(Monthy$Date, "%m"),
D1 = ifelse(Month == "01", 1,0),
D2 = ifelse(Month == "02", 1,0),
D3 = ifelse(Month == "03", 1,0),
D4 = ifelse(Month == "04", 1,0),
D5 = ifelse(Month == "05", 1,0),
D6 = ifelse(Month == "06", 1,0),
D7 = ifelse(Month == "07", 1,0),
D8 = ifelse(Month == "08", 1,0),
D9 = ifelse(Month == "09", 1,0),
D10 = ifelse(Month == "10", 1,0),
D11 = ifelse(Month == "11", 1,0),
D12 = ifelse(Month == "12", 1,0)) %>%
select(-Date, -Month)
Price <-  NULL
for (i in  2:nrow(Monthy)){
Price[i] = log(Monthy$Return[i] / Monthy$Return[i-1])
}
Monthy$Price <- Price
Monthy$Return <- NULL
summary(Monthy)
Model <- lm(Price ~ D12, data = Monthy)
summary(Model)
Model <- lm(Price ~ ., data = Monthy)
summary(Model)
Monthy <- na.omit(Monthy)
Model <- lm(Price ~ ., data = Monthy)
summary(Model)
Monthy_close_prices <- read_csv(file.choose())
install.packages(c("combinat", "pps", "survey"))
library(pps)
library(survey)
library(readxl)
library(dplyr)
<<<<<<< HEAD
qqdf_T36133 <- qqdf %>% filter(station == "T36133")
head(qqdf_T36133)
## ggplot plot
ggdf_T36133 <- ggplot(data=qqdf_T36133)+
geom_point(aes(x=obs,y=gen))+
theme_bw()+
geom_abline()+
facet_grid(station ~ season)+xlab("observed")+
ylab("generated")
show(ggdf_T36133)
qqdf_T36133 <- qqdf %>% filter(station == ("T36133" &"T36137"& "T44040"& "T44120"& "T45000"))
qqdf_T36133 <- qqdf %>% filter(station == 1:5)
head(qqdf_T36133)
qqdf_T36133 <- qqdf %>% filter(station == "T36133" & station == "T36137" & station == "T44040"& station =="T44120"& station =="T45000")
head(qqdf_T36133)
#they <- c("T36133", "T36137", "T44040", "T44120", "T45000", "T45001", "T45002", "T45003", "T45004","T45007")
summary(qqdf)
qqdf_T36133 <- qqdf %>% filter(station %in% c("T36133", "T36137", "T44040", "T44120", "T45000"))
head(qqdf_T36133)
## ggplot plot
ggdf_T36133 <- ggplot(data=qqdf_T36133)+
geom_point(aes(x=obs,y=gen))+
theme_bw()+
geom_abline()+
facet_grid(station ~ season)+xlab("observed")+
ylab("generated")
show(ggdf_T36133)
install.packages("RGENERATEPREC")
install.packages("RGENERATEPREC")
install.packages("RGENERATEPREC")
install.packages("copula")
install.packages("RGENERATEPREC")
install.packages("RGENERATEPREC")
install.packages("RGENERATEPREC", dependencies = FALSE)
install.packages("RGENERATEPREC")
install.packages("RGENERATEPREC")
install.packages("RGENERATEPREC")
install.packages("RGENERATEPREC")
install.packages("RGENERATEPREC")
install.packages("RGENERATEPREC")
install.packages("RGENERATEPREC")
=======
library(combinat)
>>>>>>> 318afc7e9a0fc68899e2ecf3a8aaabab5239f6a6
